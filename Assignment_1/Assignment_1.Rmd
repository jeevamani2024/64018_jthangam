---
title: "Assignment 1 - Fall 2023"
output:
  html_document:
    df_print: paged
  html_notebook:
    theme: cerulean
    highlight: textmate
  word_document: default
  pdf_document: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
dir.create("images")
```

***

This notebook contains the code for Assignment 1

# Summary
1) A maximum revenue of $1780 can be achieved when 40 artisanal truffles, 12 handmade chocolate
nuggets, and 4 chocolate bars are produced.

2) Constrain binnding for Chocolate bars, handmade chocolate nuggets, and artisanal truffles.\ 
a)In terms of feasibility, Artisanal Truffles: the shadow price = $2, and Range of feasibility = 47.5 to 51.6 pounds,\
b)Chocolate Nuggets produced for local order: Shadow Price = $30, Range of feasibility = 30 to 52 Pounds,\
c)Chocolate Bars: Shadow Price = $6, Range of feasibility = 29.1 to 50 Pounds.

3) Range of Optimality when the local 
store increases the daily order to 25 pounds of chocolate nuggets,:\
a)Artisanal Truffles = $20 to $38, \
b)Handmade Chocolate Nuggets = $22.5 to $26.67\
c)Chocolate Bars = $18.75 to $35.00\



```{r}
library(lpSolveAPI)
```

Problem Statement:
A renowned chocolatier, Francesco Schröeder, makes three kinds of chocolate confectionery: artisanal truffles, handcrafted chocolate nuggets, and premium gourmet chocolate bars. He uses the highest quality of cacao butter, dairy cream, and honey as the main ingredients. Francesco makes his chocolates each morning, and they are usually sold out by the early afternoon. For a pound of artisanal truffles, Francesco uses 1 cup of cacao butter, 1 cup of honey, and 1/2 cup of cream. The handcrafted nuggets are milk chocolate and take 1/2 cup of cacao, 2/3 cup of honey, and 2/3 cup of cream for each pound. Each pound of the chocolate bars uses 1 cup of cacao butter, 1/2 cup of honey, and 1/2 cup of cream. One pound of truffles, nuggets, and chocolate bars can be purchased for $35, $25, and $20, respectively. A local store places a daily order of 10 pounds of chocolate nuggets, which means that Francesco needs to make at least 10 pounds of the chocolate nuggets each day. Before sunrise each day, Francesco receives a delivery of 50 cups of cacao butter, 50 cups of honey, and 30 cups of dairy cream.\
Formulate and solve the LP model that maximizes revenue given the constraints. How much of each chocolate product should Francesco make each morning? What is the maximum daily revenue that he can make?\
Report the shadow price and the range of feasibility of each binding constraint.
If the local store increases the daily order to 25 pounds of chocolate nuggets, how much of each product should Francesco make?


We will use two methods to resolve this issue: \
The variables and coefficients are first explicitly encoded, then an .lp file will be utilized. Create and solve the LP model that, given the limitations, maximizes revenue. 
Every morning, How much of each type of chocolate should Francesco produce? and What could be the maximum per-day revenue that could be generated by him?

We define the following Decision Variables:\
Let T pounds of artisanal truffles, and N pounds of handcrafted
chocolate nuggets, B pounds of premium gourmet chocolate bars

• The Objective is to Max 35T + 25N + 20B.\ 
The constraints are\
• Cacao butter: 1x1 + 1/2x2 + 1x3 <= 50;\
• Honey: 1x1 + 2/3x2 + 1/2x3 <= 50;\
• Cream: 1/2x1 + 2/3x2 + 1/2x3 <= 30;\
• Nuggets: x2 >= 10; Non-negativity: x1 >= 0, x3 >= 0\



```{r}
# make an lp object with 0 constraints and 3 decision variables
lprec <- make.lp(0, 3)
# Now create the objective function. The default is a minimization problem.
set.objfn(lprec, c(35, 25, 20))
# As the default is a minimization problem, we change the direction to set maximization
lp.control(lprec,sense='max')
```



```{r}
# Adding four constraints.
add.constraint(lprec, c(1, 1/2, 1), "<=", 50)
add.constraint(lprec, c(1, 2/3, 1/2), "<=", 50)
add.constraint(lprec, c(1/2, 2/3, 1/2), "<=", 30)
add.constraint(lprec, c(0, 1, 0), ">=", 10)
# Setting bounds for variables.
set.bounds(lprec, lower = c(0, 0, 0), columns = c(1, 2, 3)) #Not really needed
# To identify the variables and constraints, we can set variable names and name the constraints
RowNames <- c("Cacao_Butter", "Honey", "Diary_Cream", "NUggets_Preorder")
ColNames <- c("Artisanal_Truffel", "Chocalate_Nuggets", "Chocalate_Bars")
dimnames(lprec) <- list(RowNames, ColNames)
# Now, print out the model
lprec
```

Saving the Model to Assignment_1.lp file


```{r}
write.lp(lprec, filename = "Assignment_1.lp", type = "lp")
#Let's solve the above LP problem
solve(lprec)
```
The output above doesn't indicate that the answer is 0, but that there was a successful solution.\
We now output the value of the objective function, and the variables

```{r}
get.objective(lprec)
```



```{r}
varV <- get.variables(lprec)
```




Consider a different approach to inputting the problem formulation before looking at other output values.\ 
Using the LP format, let's create a text file containing the problem formulation. 
Using the write.lp statement, we also generated an lp file. 

Now let’s take a look at the Assignment_1.lp file.\
We can open the file in the Files list on the right side of RStudio.


```{r}
x <- read.lp("Assignment_1.lp") # create an lp object x
x # display x
```

```{r}
solve(x)
get.objective(x) # get objective value
get.variables(x) # get values of decision variables
get.constraints(x) # get constraint RHS values
```

According to the solution, the revenue is 1780, with the first variable value being 40, and the second variable value being 12, and the third variable value being 4.\
There is a problem with reading the output because lpsolveAPI does not write the variable name next to the solution.\
The output variables are in the order they appear in the LP formulation. Here, it is Artisanal Truffel, Handcrafted Chocolate Nuggets, and then Choclate Bars. 

----------------------------------------------------

Report the shadow price and the range of feasibility of each binding constraint.

```{r}
get.sensitivity.rhs(lprec) # get shadow prices
```



```{r}
get.sensitivity.obj(lprec) # get reduced cost
```


---------------------------------------------------
If the local store increases the daily order to 25 pounds of chocolate nuggets, how much of each product should Francesco make?

Let's, create an LP object with 3 decision variable variables and 0 constraints.

```{r}
lprec <- make.lp(0, 3)
```

Now, let's create an objective function.

```{r}
set.objfn(lprec, c(35, 25, 20))
```

Now, let's change the direction
to set maximization because the default is a minimization problem.

```{r}
lp.control(lprec,sense='max')
```

Adding updated constraints.\
Increased daily order from 10 pounds to 25 pounds


```{r}
add.constraint(lprec, c(1, 1/2, 1), "<=", 50)
add.constraint(lprec, c(1, 2/3, 1/2), "<=", 50)
add.constraint(lprec, c(1/2, 2/3, 1/2), "<=", 30)
add.constraint(lprec, c(0, 1, 0), ">=", 25)
```

Set bound for variables

```{r}
set.bounds(lprec, lower = c(0, 0, 0), columns = c(1, 2, 3)) #Not really needed

```

To identify the variables and constraints,\ 
Let set the variable names and name the constraints

```{r}
RowNames <- c("Cacao_Butter", "Honey", "Diary_Cream", "NUggets_Preorder")
ColNames <- c("Aritisan_Truffel", "Chocalate_Nuggets", "Chocalate_Bars")
dimnames(lprec) <- list(RowNames, ColNames)
# Now, print out the model
lprec
```

Saving the Model to Assignment_1a.lp file
```{r}
write.lp(lprec, filename = "Assignment_1a.lp", type = "lp")
```



Solve the above LP Problem

```{r}
solve(lprec)
get.objective(lprec)
x <- read.lp("Assignment_1a.lp") # create an lp object x
x # display x
```



```{r}

solve(lprec)
get.objective(lprec) 
get.variables(lprec) 
get.constraints(lprec) 
```
